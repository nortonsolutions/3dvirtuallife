<!DOCTYPE html>
<html lang="en">

    <!-- Inject server-side environment variables for client-side use -->
    <script>
        window.base_url = {{{ jsonStringify base_url }}};
    </script>    
    <head>
        <title>3D Virtual Life - Epic Adventure Awaits (beta)</title>
        {{>headerStuff fontAwesome=true jQuery=true bootStrap=true handlebars=true}}
        <style>
            body {
                min-height: 100vh;
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                overflow-y: auto;
            }
            
            .hero-section {
                background: rgba(0, 0, 0, 0.7);
                border-radius: 20px;
                margin: 20px auto;
                max-width: 1200px;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
                overflow: hidden;
            }
            
            .hero-header {
                background: linear-gradient(45deg, #512262, #4ecdc4);
                padding: 20px;
                text-align: center;
                color: white;
            }
            
            .hero-title {
                font-size: 2.5rem;
                font-weight: bold;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
                margin-bottom: 8px;
            }
            
            .hero-subtitle {
                font-size: 1.2rem;
                opacity: 0.9;
                margin-bottom: 15px;
            }
            
            .game-preview {
                position: relative;
                margin: 10px 0;
            }
            
            .game-preview img {
                width: 100%;
                max-width: 350px;
                border-radius: 10px;
                box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
                transition: transform 0.3s ease;
            }
            
            .game-preview img:hover {
                transform: scale(1.02);
            }
            
            .carousel-control-prev,
            .carousel-control-next {
                width: 5%;
                opacity: 0.7;
            }
            
            .carousel-control-prev:hover,
            .carousel-control-next:hover {
                opacity: 1;
            }
            
            .carousel-indicators li {
                background-color: rgba(255, 255, 255, 0.5);
            }
            
            .carousel-indicators .active {
                background-color: #4ecdc4;
            }
            
            .content-wrapper {
                padding: 20px;
            }
            
            .login-section {
                background: rgba(255, 255, 255, 0.95);
                border-radius: 15px;
                padding: 20px;
                box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            }
            
            .info-section {
                color: white;
            }
            
            .github-card {
                background: rgba(255, 255, 255, 0.1);
                border-radius: 10px;
                padding: 15px;
                margin-bottom: 15px;
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 255, 255, 0.2);
                transition: transform 0.3s ease, background 0.3s ease;
            }
            
            .github-card:hover {
                transform: translateY(-5px);
                background: rgba(255, 255, 255, 0.15);
            }
            
            .github-link {
                color: white;
                text-decoration: none;
                display: flex;
                align-items: center;
                gap: 15px;
            }
            
            .github-link:hover {
                color: #4ecdc4;
                text-decoration: none;
            }
            
            .github-icon {
                font-size: 2rem;
            }
            
            .form-control {
                border-radius: 10px;
                border: 2px solid #e0e0e0;
                padding: 12px 15px;
                transition: border-color 0.3s ease;
            }
            
            .form-control:focus {
                border-color: #4ecdc4;
                box-shadow: 0 0 0 0.2rem rgba(78, 205, 196, 0.25);
            }
            
            .btn-primary {
                background: linear-gradient(45deg, #667eea, #764ba2);
                border: none;
                border-radius: 10px;
                padding: 12px 30px;
                font-weight: bold;
                transition: transform 0.3s ease;
            }
            
            .btn-primary:hover {
                transform: translateY(-2px);
                background: linear-gradient(45deg, #5a6fd8, #6a4190);
            }
            
            .feature-list {
                list-style: none;
                padding: 0;
            }
            
            .feature-list li {
                padding: 10px 0;
                border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            }
            
            .feature-list li:before {
                content: "‚öîÔ∏è";
                margin-right: 10px;
            }
            
            .toggle-link {
                color: #4ecdc4;
                cursor: pointer;
                text-decoration: underline;
                font-weight: bold;
            }
            
            .toggle-link:hover {
                color: #ff6b6b;
            }
        </style>
    </head>
    <body>
        <header>
            {{!-- {{>navbar mainActive="active"}} --}}
        </header>
        <main>
            <div class="hero-section">
                <div class="hero-header">
                    <h3 class="hero-subtitle">{{ PRE_WELCOME_MESSAGE }}</h3>
                    <h1 class="hero-title">{{ WELCOME_MESSAGE }}</h1>
                    <p class="hero-subtitle">{{ WELCOME_SUBTITLE }}</p>
                </div>
                
                <div class="content-wrapper">
                    <!-- First Row: Game Preview and Login -->
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <div class="game-preview text-center">
                                <div id="gameCarousel" class="carousel slide" data-ride="carousel" data-interval="4000">
                                    {{#if GAME_PREVIEW_IMAGES}}
                                    <!-- Indicators -->
                                    <ol class="carousel-indicators">
                                        {{#each GAME_PREVIEW_IMAGES}}
                                        <li data-target="#gameCarousel" data-slide-to="{{@index}}" {{#if @first}}class="active"{{/if}}></li>
                                        {{/each}}
                                    </ol>
                                    
                                    <!-- Slides -->
                                    <div class="carousel-inner">
                                        {{#each GAME_PREVIEW_IMAGES}}
                                        <div class="carousel-item {{#if @first}}active{{/if}}">
                                            <img src="{{this}}" alt="3D Virtual Life Game Screenshot {{@index}}" class="img-fluid">
                                        </div>
                                        {{/each}}
                                    </div>
                                    
                                    <!-- Controls -->
                                    <a class="carousel-control-prev" href="#gameCarousel" role="button" data-slide="prev">
                                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                        <span class="sr-only">Previous</span>
                                    </a>
                                    <a class="carousel-control-next" href="#gameCarousel" role="button" data-slide="next">
                                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                        <span class="sr-only">Next</span>
                                    </a>
                                    {{else}}
                                    <!-- Fallback single image -->
                                    <img src="https://github.com/nortonsolutions/3dvirtuallife/raw/main/3dvirtuallife_1.png" alt="3D Virtual Life Game Screenshot" class="img-fluid">
                                    {{/if}}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="login-section">
                        {{#if showLogin}}
                        <div id="loginForm">
                            <h4 style="color: #333; margin-bottom: 15px;">üö™ Enter the Adventure</h4>
                            <form action="/login" method="post">
                                <div class="mb-2">
                                    <label for="username" class="form-label">Username</label>
                                    <input class="form-control form-control-sm" type="text" id="username" name="username" placeholder="Enter your username" required>
                                </div>
                                <div class="mb-2">
                                    <label for="password" class="form-label">Password</label>
                                    <input class="form-control form-control-sm" type="password" name="password" id="password" placeholder="Enter your password" required>
                                </div>
                                <div class="d-grid">
                                    <button type="submit" class="btn btn-primary">üéØ Start Adventure</button>
                                </div>
                                {{#if alertText}}
                                <div class="alert alert-info mt-2 py-1">{{ alertText }}</div>
                                {{/if}}
                            </form>
                            <div class="text-center mt-2">
                                <small class="toggle-link" id="newUser">New adventurer? Create account</small>
                            </div>
                        </div>
                        {{else}}
                        <div class="alert alert-warning py-2">
                            <h5>‚ö†Ô∏è Maintenance Mode</h5>
                            <p class="mb-0">Logins are temporarily disabled.</p>
                        </div>
                        {{/if}}

                        <div id="newUserRegistrationForm" class="d-none">
                            <h4 style="color: #333; margin-bottom: 15px;">‚öîÔ∏è Join the Quest</h4>
                            <form action="/register" method="post">
                                <div class="mb-2">
                                    <label for="reg-username" class="form-label">Username</label>
                                    <input class="form-control form-control-sm" type="text" id="reg-username" name="username" placeholder="Choose a username" required>
                                </div>
                                <div class="mb-2">
                                    <label for="firstname" class="form-label">First Name</label>
                                    <input class="form-control form-control-sm" type="text" id="firstname" name="firstname" placeholder="Your first name" required>
                                </div>
                                <div class="mb-2">
                                    <label for="surname" class="form-label">Last Name</label>
                                    <input class="form-control form-control-sm" type="text" id="surname" name="surname" placeholder="Your last name" required>
                                </div>
                                <div class="mb-2">
                                    <label for="reg-password" class="form-label">Password</label>
                                    <input class="form-control form-control-sm" type="password" name="password" id="reg-password" placeholder="Create a strong password" required>
                                </div>
                                <div class="d-grid">
                                    <button type="submit" class="btn btn-primary">üõ°Ô∏è Create Character</button>
                                </div>
                                {{#if alertText}}
                                <div class="alert alert-info mt-2 py-1">{{ alertText }}</div>
                                {{/if}}
                            </form>
                            <div class="text-center mt-2">
                                <small class="toggle-link" id="login">Already have an account? Login</small>
                            </div>
                        </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Second Row: GitHub and Features -->
                    <div class="row">
                        <div class="col-md-6">
                            <div class="info-section">
                                <div class="github-card">
                                    <a href="https://github.com/nortonsolutions/3DvirtualLife" target="_blank" class="github-link">
                                        <i class="fab fa-github github-icon mr-2"></i>
                                        <div>
                                            <h5 style="margin: 0;">View on GitHub</h5>
                                            <small style="opacity: 0.8;">Explore the source code</small>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="info-section">
                                <h5 class="mb-2">üéÆ Game Features</h5>
                                <ul class="feature-list" style="font-size: 0.9rem;">
                                    <li style="padding: 5px 0;">3D Multiplayer Experience</li>
                                    <li style="padding: 5px 0;">Real-time Adventure</li>
                                    <li style="padding: 5px 0;">Character Progression</li>
                                    <li style="padding: 5px 0;">Interactive World and Trading</li>
                                    <li style="padding: 5px 0;">THREE.js, Node.js, socket.io, Express.js</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>


        <script>
            document.getElementById('newUser').addEventListener('click', (e) => {
                document.getElementById('loginForm').classList.add('d-none');
                document.getElementById('newUserRegistrationForm').classList.remove('d-none');
            });

            document.getElementById('login').addEventListener('click', (e) => {
                document.getElementById('loginForm').classList.remove('d-none');
                document.getElementById('newUserRegistrationForm').classList.add('d-none');
            });
        </script>
    </body>
</html>